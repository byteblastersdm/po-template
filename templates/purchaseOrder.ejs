<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Purchase Order</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      color: #333;
      background: #fff;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 4px solid #007bdb;
      padding-bottom: 16px;
      margin-bottom: 24px;
    }

    .header h1 {
      color: #007bdb;
      font-size: 36px;
      margin: 0;
    }

    .logo {
      background: #f4a100;
      color: white;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
    }

    .info-grid {
      display: flex;
      justify-content: space-between;
      margin-bottom: 24px;
    }

    .info-block,
    .meta-box {
      font-size: 14px;
      line-height: 1.6;
      width: 48%;
    }

    .info-block strong {
      display: block;
      font-weight: bold;
    }

    .meta-box {
      background: #f7f7f7;
      padding: 16px;
    }

    .ship-to-supplier {
      display: flex;
      justify-content: space-between;
      margin-bottom: 24px;
    }

    .terms-box {
      font-size: 14px;
      margin-top: 30px;
      width: 40%;
      float: left;
      white-space: pre-line;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    table thead th {
      border-bottom: 2px solid #007bdb;
      padding: 10px;
      text-align: left;
      font-size: 14px;
      background: #f9f9f9;
    }

    table tbody td {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      font-size: 14px;
    }

    .totals {
      width: 300px;
      float: right;
      margin-top: 24px;
      font-size: 14px;
    }

    .totals table {
      width: 100%;
    }

    .totals td {
      padding: 6px 0;
    }

    .totals .label {
      font-weight: bold;
    }

    .totals .total-row td {
      color: #007bdb;
      font-weight: bold;
    }

    .signature {
      display: flex;
      justify-content: space-between;
      margin-top: 100px;
      width: 100%;
      clear: both;
      padding-top: 60px;
    }

    .signature .box {
      width: 40%;
      text-align: center;
      border-top: 1px solid #aaa;
      padding-top: 10px;
      font-size: 13px;
      color: #555;
    }

    .pre {
      white-space: pre-line;
    }
  </style>
</head>

<body>
  <div class="header">
    <div class="header-left">
      <img src="<%= logo %>" width="100" height="100" alt="Company Logo">
    </div>
    <div class="header-right">
      <h1>PURCHASE ORDER</h1>
      <p><strong>PO Number:</strong> <%= poNumber %></p>
      <p><strong>Date:</strong> <%= poDate %></p>
    </div>
  </div>


  <div class="info-grid">
    <div class="info-block">
      <span style="font-size: larger;"><strong><%= buyer.company %></strong></span>
      <div class="pre"><%= buyer.address %></div>
      Phone: <%= buyer.phone %><br>
      Email: <%= buyer.email %><br>
      GSTIN: <%= buyer.gstin %>
    </div>
    <div class="meta-box">
      <strong>Supplier</strong><br>
      <span><%= supplier.company %></span>
      <div class="pre"><%= supplier.address %></div>
      Phone: <%= supplier.phone %><br>
      Email: <%= supplier.email %><br>
      GSTIN: <%= supplier.gstin %><br>
      Terms: <%= supplier.terms || "N/A" %>
    </div>
  </div>

  <div class="ship-to-supplier">
    <div class="info-block">
      <strong>Ship to</strong>
       <% if (Array.isArray(shipTo)) { %>
      <ul>
        <% shipTo.forEach(term => { %>
          <li><%= term %></li>
        <% }) %>
      </ul>
    <% } else { %>
      <div class="pre"><%= shipTo %></div>
    <% } %>
    </div>
    <div class="info-block"></div>
  </div>

  <table>
    <thead>
      <tr>
        <th>Item #</th>
        <th>Description</th>
        <th>Qty</th>
        <th>Unit Price</th>
        <th>Tax</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      <% items.forEach((item)=> { %>
        <tr>
          <td><%= item.name %></td>
          <td><%= item.desc %></td>
          <td><%= item.qty %></td>
          <!-- <td><%= item.unit || "pcs" %></td> -->
          <td>₹ <%= item.price.toFixed(2) %></td>
          <td>₹ <%= item.tax.toFixed(2) %></td>
          <td>₹ <%= (item.qty * item.price).toFixed(2) %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <div class="terms-box">
    <strong>Terms & Conditions</strong><br>
    <% if (Array.isArray(terms)) { %>
      <ul>
        <% terms.forEach(term => { %>
          <li><%= term %></li>
        <% }) %>
      </ul>
    <% } else { %>
      <div class="pre"><%= terms %></div>
    <% } %>
  </div>

  <div class="totals">
    <table>
      <tr>
        <td class="label">Subtotal</td>
        <td>₹ <%= subtotal.toFixed(2) %></td>
      </tr>
      <tr>
        <td class="label">Tax</td>
        <td>₹ <%= totalTax.toFixed(2) %></td>
      </tr>
      <tr>
        <td class="label">Shipping</td>
        <td>₹ 0</td>
      </tr>
      <tr>
        <td class="label">Other</td>
        <td>₹ 0</td>
      </tr>
      <tr class="total-row">
        <td class="label">Total</td>
        <td>₹ <%= grandTotal.toFixed(2) %></td>
      </tr>
    </table>
  </div>

  <div class="signature">
    <div class="box">Authorized Signature (Buyer)</div>
    <div class="box">Accepted By (Supplier)</div>
  </div>
</body>

</html>
